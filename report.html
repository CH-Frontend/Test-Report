<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en"> <!--<![endif]-->
<head>
    <meta content="webkit" name="renderer" />
    <title>日报</title>

    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon -->
    <!-- <link rel="shortcut icon" href="favicon.ico"> -->
    <!-- Web Fonts -->
    <link rel="stylesheet" href="assets/css/css.css">

    <!-- CSS Global Compulsory -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/plugins/animate.css">
    <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.min.css">
    <!-- CSS Theme -->
    <link rel="stylesheet" href="assets/css/blue.css" id="style_color">
    <link rel="stylesheet" href="assets/plugins/iview/iview.css">
    <link href="assets/plugins/ionicons/css/ionicons.css" rel="stylesheet">
    <style type="text/css">
        .btn-u-small:hover {
            background: #40E0D0 !important;
            color: #fff !important;
        }
    </style>
</head>

<body>
<div id="app">
    <div class="wrapper">
        <!--=== Breadcrumbs ===-->
        <div class="breadcrumbs" style="background-color: rgba(22, 155, 213, 1);height: 60px;">
            <div class="container" style="width: 100%;">
                <h1 class="pull-left" style="color: #fff;margin-top: 10px;">测试日报质量平台</h1>
                <span class="pull-right" style="margin-top: 14px;font-size: 16px;"><span
                        style="color: #fff;margin-right: 50px;">{{nowTime}}</span><span
                        style="color: #fff;margin-right: 50px;">{{userName}}</span><i-button
                        @click="modal0 = true">退出</i-button></span>
            </div>
        </div><!--/breadcrumbs-->
        <!--=== End Breadcrumbs ===-->
        <div style="background-color: rgba(242, 242, 242, 1);">
            <div style="padding-top: 15px;padding-bottom: 15px;">
                <span><i-button style="margin-left: 50px;" @click="goBack">返回</i-button>
                    <i-button
                            type="primary"
                            style="margin-left: 20px;"
                            :loading="loading"
                            @click="goSubmit">提交</i-button><label
                            style="font-size: 2em;margin-left: 25%;">{{proname}}项目日报</label></span>
            </div>
        </div>
        <div style="width: 80%;margin-left: 10%;">
            <div style="margin-top: 10px;font-size: 14px;margin-bottom: 10px;">
        	<span style="
        	  display: inline-block;
			  margin-right: 4px;
			  font-family: SimSun;
			  line-height: 1;
			  font-size: 14px;
			  color: #f5222d;">*</span>
                <span>请选择填写日期：
                <date-picker
                        :open="open"
                        :value="searchDate"
                        :options="optionsDate"
                        type="date"
                        @on-change="ChangeDate"
                >
                    <a href="javascript:void(0)" @click="handleClick">
                        <Icon type="ios-calendar-outline"></Icon>
                        <template v-if="searchDate === ''">请选择日期</template>
                        <template v-else>{{ searchDate }}</template>
                    </a>
                </date-picker>
                    <!-- <date-picker @click="handleClick" :value="searchDate" :open="open" type="date" @on-open-change="onOpenChange" @on-change="ChangeDate" :options="optionsDate" placeholder="请选择日期" style="width: 200px"></date-picker> -->
            </span>
                <span>（如补填或更新非当天日报，请先选择填写日期，否则填写的数据将被改变）</span>
            </div>
        </div>
        <div style="width: 80%;margin-left: 10%;">
            <!-- <div style="margin-top: 10px;font-size: 14px;margin-bottom: 10px;">
                <span>交付物名称/版本：{{deliverable}}</span><span style="margin-left: 16%;">基线时间：{{Baselinetime}}</span><span style="margin-left: 16%;">当前测试版本数：{{Versionnumber}}</span><span style="margin-left: 16%;">所属大项目群：{{group}}</span>
            </div> -->
            <!-- <div style="margin-top: 20px;">
                <i-table border :columns="columns0" :data="data0"></i-table>
            </div> -->
        </div>
        <div style="background-color: rgba(242, 242, 242, 1);">
            <div style="padding-top: 15px;padding-bottom: 15px;margin-left: 10%;font-size: 14px;">
                <span>项目测试结论：<i-button style="width:100px;">{{Testresult}}</i-button><label
                        style="font-weight: normal;margin-left: 10%;">项目当前风险及障碍：</label>
                        <i-input type="textarea"
                            :rows="1"
                            v-model="alldata.projectJournal.description"
                            placeholder=""
                            style="width: 500px"></i-input>
                        <i-button
                            type="primary"
                            style="margin-left: 20px;"
                            :loading="loading"
                            @click="checkNotCloseRisk">未关闭风险及障碍列表</i-button>
                        <i-button
                            type="primary"
                            style="margin-left: 20px;"
                            :loading="loading"
                            @click="checkCloseRisk">已关闭风险及障碍列表</i-button>

                </span>
            </div>
        </div>
        <div style="width: 80%;margin-left: 10%;" v-show="isFunction">
            <div style="margin-top: 10px;margin-bottom: 10px;">
                <span style="color: #666666;font-weight: bold;font-size: 16px;">功能测试 <i-button @click="functionHistory" type="info" size="small" style="margin-left: 20px">查看历史记录</i-button></span>
                <hr style="border: 1px solid #BFBFBF;margin-top: 10px;"/>
                <p style="font-size: 12px;margin-top: 10px;">无A/B级bug遗留，功能测试通过，否则不通过</p>
            </div>
            <div style="margin:5px 0px 0px;">
                <table border="1" width="100%" height="243px" style="text-align: center;">
                    <thead>
                    <tr style="height: 30px;">
                        <th style="text-align: center;">bug/漏洞/指标</th>
                        <th style="text-align: center;">今日发现bug数</th>
                        <th style="text-align: center;">今日解决bug数</th>
                        <th style="text-align: center;">今日重新打开bug数</th>
                        <th style="text-align: center;">累计发现bug数量/结果</th>
                        <th style="text-align: center;">累计遗留bug数量/结果</th>
                        <th style="text-align: center;">结论</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>A级</td>
                        <td><input v-model="alldata.functionJournal.bugA"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugAClosed"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugAReopen"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugASum"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center;"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugARemain"
                                   disabled="disabled"
                                   style="border: none; width: 100%; text-align: center"/></td>
                        <td rowspan="4">
                            <radio-group @on-change="functionRadio" v-model="functionResult" vertical
                                         style="text-align: center;">
                                <Radio :label="-1">
                                    <span>测试中</span>
                                </Radio>
                                <Radio :label="1">
                                    <span>通&#12288;过</span>
                                </Radio>
                                <Radio :label="0">
                                    <span>不通过</span>
                                </Radio>
                                <Radio :label="2">
                                    <span>未测试</span>
                                </Radio>
                            </radio-group>
                        </td>
                    </tr>
                    <tr>
                        <td>B级</td>
                        <td><input v-model="alldata.functionJournal.bugB"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugBClosed"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugBReopen"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugBSum"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugBRemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                    </tr>
                    <tr>
                        <td>C级</td>
                        <td><input v-model="alldata.functionJournal.bugC"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugCClosed"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugCReopen"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugCSum"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugCRemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                    </tr>
                    <tr>
                        <td>D级</td>
                        <td><input v-model="alldata.functionJournal.bugD"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugDClosed"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.functionJournal.bugDReopen"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugDSum"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.functionJournal.bugDRemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div style="background-color: rgba(242, 242, 242, 1);height: 20px;margin-top: 20px;" v-show="isFunction">
        </div>
        <div style="width: 80%;margin-left: 10%;" v-show="isCode">
            <div style="margin-top: 10px;margin-bottom: 10px;">
                <span style="color: #666666;font-weight: bold;font-size: 16px;">代码测试 <i-button @click="codeHistory" type="info" size="small" style="margin-left: 20px">查看历史记录</i-button></span>
                <hr style="border: 1px solid #BFBFBF;margin-top: 10px;"/>
                <p style="font-size: 12px;margin-top: 10px;">无A/B级bug遗留，代码测试通过，否则不通过</p>
            </div>
            <div style="margin:5px 0px 0px;">
                <table border="1" width="100%" height="100px" style="text-align: center;">
                    <thead>
                    <tr style="height: 30px;">
                        <th style="text-align: center;">bug/漏洞/指标</th>
                        <th style="text-align: center;">今日发现bug数</th>
                        <th style="text-align: center;">今日解决bug数</th>
                        <th style="text-align: center;">今日重新打开bug数</th>
                        <th style="text-align: center;">累计发现bug数量/结果</th>
                        <th style="text-align: center;">累计遗留bug数量/结果</th>
                        <th style="text-align: center;">结论</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>A级</td>
                        <td><input v-model="alldata.codeJournal.bugA" style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.codeJournal.bugAClosed" style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.codeJournal.bugAReopen" style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.codeJournal.bugASum"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.codeJournal.bugARemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                        <td rowspan="2">
                            <radio-group @on-change="codeRadio" v-model="codeResult" vertical
                                         style="text-align: center;">
                                <Radio :label="-1">
                                    <span>测试中</span>
                                </Radio>
                                <Radio :label="1">
                                    <span>通&#12288;过</span>
                                </Radio>
                                <Radio :label="0">
                                    <span>不通过</span>
                                </Radio>
                                <Radio :label="2">
                                    <span>未测试</span>
                                </Radio>
                            </radio-group>
                        </td>
                    </tr>
                    <tr>
                        <td>B级</td>
                        <td><input v-model="alldata.codeJournal.bugB" style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.codeJournal.bugBClosed" style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.codeJournal.bugBReopen" style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.codeJournal.bugBSum"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.codeJournal.bugBRemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div style="background-color: rgba(242, 242, 242, 1);height: 20px;margin-top: 20px;" v-show="isCode">
        </div>
        <div style="width: 80%;margin-left: 10%;" v-show="isProperty">
            <div style="margin-top: 10px;margin-bottom: 10px;">
                <span style="color: #666666;font-weight: bold;font-size: 16px;">性能测试 <i-button @click="propertyHistory" type="info" size="small" style="margin-left: 20px">查看历史记录</i-button></span>
                <hr style="border: 1px solid #BFBFBF;margin-top: 10px;"/>
                <p style="font-size: 12px;margin-top: 10px;">所有指标达标，则性能测试通过，否则不通过</p>
            </div>
            <div style="margin:5px 0px 0px;">
                <table border="1" width="100%" height="100px" style="text-align: center;">
                    <thead>
                    <tr style="height: 30px;">
                        <th style="text-align: center;">bug/漏洞/指标</th>
                        <th style="text-align: center;">达标数量</th>
                        <th style="text-align: center;">不达标数量</th>
                        <th style="text-align: center;">达标率</th>
                        <th style="text-align: center;">结论</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>云端性能</td>
                        <td><input v-model="alldata.propertyJournal.cloudPass"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.propertyJournal.cloudFail"
                                   style="border: none; width: 100%; height: 100%; text-align: center"/></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.propertyJournal.cloudPassRate + '%'"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td rowspan="2">
                            <radio-group @on-change="propertyRadio" v-model="capacityResult" vertical
                                         style="text-align: center;">
                                <Radio :label="-1">
                                    <span>测试中</span>
                                </Radio>
                                <Radio :label="1">
                                    <span>通&#12288;过</span>
                                </Radio>
                                <Radio :label="0">
                                    <span>不通过</span>
                                </Radio>
                                <Radio :label="2">
                                    <span>未测试</span>
                                </Radio>
                            </radio-group>
                        </td>
                    </tr>
                    <tr>
                        <td>Web性能</td>
                        <td><input v-model="alldata.propertyJournal.webPass"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.propertyJournal.webFail"
                                   style="border: none; width: 100%; height: 100%; text-align: center"/></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.propertyJournal.webPassRate + '%'"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div style="background-color: rgba(242, 242, 242, 1);height: 20px;margin-top: 20px;" v-show="isProperty">
        </div>
        <div style="width: 80%;margin-left: 10%;margin-bottom: 50px;" v-show="isSecurity">
            <div style="margin-top: 10px;margin-bottom: 10px;">
                <span style="color: #666666;font-weight: bold;font-size: 16px;">安全测试 <i-button @click="securityHistory" type="info" size="small" style="margin-left: 20px">查看历史记录</i-button></span>
                <hr style="border: 1px solid #BFBFBF;margin-top: 10px;"/>
                <p style="font-size: 12px;margin-top: 10px;">无高危/中危漏洞遗留，安全测试通过，否则不通过</p>
            </div>
            <div style="margin:5px 0px 0px;">
                <table border="1" width="100%" height="190px" style="text-align: center;">
                    <thead>
                    <tr style="height: 30px;">
                        <th style="text-align: center;">bug/漏洞/指标</th>
                        <th style="text-align: center;">今日发现bug数</th>
                        <th style="text-align: center;">今日解决bug数</th>
                        <th style="text-align: center;">今日重新打开bug数</th>
                        <th style="text-align: center;">累计发现bug数量/结果</th>
                        <th style="text-align: center;">累计遗留bug数量/结果</th>
                        <th style="text-align: center;">结论</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>高危</td>
                        <td><input v-model="alldata.securityJournal.bugH"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.securityJournal.bugHClosed"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.securityJournal.bugHReopen"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.securityJournal.bugHSum"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.securityJournal.bugHRemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                        <td rowspan="3">
                            <radio-group @on-change="securityRadio" v-model="securityResult" vertical
                                         style="text-align: center;">
                                <Radio :label="-1">
                                    <span>测试中</span>
                                </Radio>
                                <Radio :label="1">
                                    <span>通&#12288;过</span>
                                </Radio>
                                <Radio :label="0">
                                    <span>不通过</span>
                                </Radio>
                                <Radio :label="2">
                                    <span>未测试</span>
                                </Radio>
                            </radio-group>
                        </td>
                    </tr>
                    <tr>
                        <td>中危</td>
                        <td><input v-model="alldata.securityJournal.bugM"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.securityJournal.bugMClosed"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.securityJournal.bugMReopen"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.securityJournal.bugMSum"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.securityJournal.bugMRemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                    </tr>
                    <tr>
                        <td>低危</td>
                        <td><input v-model="alldata.securityJournal.bugL"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.securityJournal.bugLClosed"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td><input v-model="alldata.securityJournal.bugLReopen"
                                   style="border: none; width: 100%; height: 100%; text-align: center"></td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.securityJournal.bugLSum"
                                                                  style="border: none; width: 100%; text-align: center"/>
                        </td>
                        <td style="background-color: #EBEBEB;"><p v-html="alldata.securityJournal.bugLRemain"
                                                                  disabled="disabled"
                                                                  style="border: none; width: 100%; text-align: center"/></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <Modal
                v-model="modal0"
                title="提示"
                @on-ok="ok"
                @on-cancel="cancel">
            <p>您可能有数据没有保存，确认退出吗？</p>
        </Modal>
        <Modal
                v-model="modal1"
                title="确认"
                @on-ok="ok1"
                @on-cancel="cancel1">
            <p>选择日期将导致数据更新，确定要选择日期吗？</p>
        </Modal>
        <Modal
                v-model="modal2"
                title="功能测试日报历史记录"
                width="800px"
                @on-ok="ok2"
                @on-cancel="cancel2">
            <i-table :columns="functioncolumns" :data="functiondata"></i-table>
            <div slot="footer">
                <i-button type="primary" @click="cancel2">关闭</i-button>
            </div>
        </Modal>
        <Modal
                v-model="modal3"
                title="代码测试日报历史记录"
                width="800px"
                @on-ok="ok3"
                @on-cancel="cancel3">
            <i-table :columns="codecolumns" :data="codedata"></i-table>
            <div slot="footer">
                <i-button type="primary" @click="cancel3">关闭</i-button>
            </div>
        </Modal>
        <Modal
                v-model="modal4"
                title="性能测试日报历史记录"
                width="800px"
                @on-ok="ok4"
                @on-cancel="cancel4">
            <i-table :columns="propertycolumns" :data="propertydata"></i-table>
            <div slot="footer">
                <i-button type="primary" @click="cancel4">关闭</i-button>
            </div>
        </Modal>
        <Modal
                v-model="modal5"
                title="安全测试日报历史记录"
                width="800px"
                @on-ok="ok5"
                @on-cancel="cancel5">
            <i-table :columns="securitycolumns" :data="securitydata"></i-table>
            <div slot="footer">
                <i-button type="primary" @click="cancel5">关闭</i-button>
            </div>
        </Modal>
        <Modal
            v-model="modal6"
            title="未关闭风险及障碍列表"
            width="800px"
            @on-ok="ok6"
            @on-cancel="cancel6">
            <i-table :columns="notriskcolumns" :data="notriskdata"></i-table>
            <div id="Bar1" style="margin-top: 10px;width: 750px;height:300px;">
			</div>
            <div slot="footer">
                <i-button type="primary" @click="cancel6">关闭</i-button>
            </div>
        </Modal>
        <Modal
            v-model="modal7"
            title="已关闭风险及障碍列表"
            width="800px"
            @on-ok="ok7"
            @on-cancel="cancel7">
            <i-table :columns="riskcolumns" :data="riskdata"></i-table>
            <div id="Bar2" style="margin-top: 10px;width: 750px;height:300px;">
			</div>
            <div slot="footer">
                <i-button type="primary" @click="cancel7">关闭</i-button>
            </div>
        </Modal>
    </div>
</div>
<script type="text/javascript" src="assets/js/vue.js"></script>
<script src="assets/plugins/iview/iview.min.js"></script>
<script type="text/javascript" src="assets/plugins/jquery/jquery.min.js"></script>
<script type="text/javascript" src="assets/plugins/jquery/jquery-migrate.min.js"></script>
<script type="text/javascript" src="assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/plugins/echarts/echarts.js"></script>
<script type="text/javascript">
    var vm = new Vue({
        el: '#app',
        data: {
            optionsDate: {
                disabledDate(date) {
                    // return date && date.valueOf() >= Date.now();
                    return (date && date.valueOf() >= Date.now()) || (date && date.valueOf() <= Date.now() - 86400000 * 4)
                }
            },
            open: false,
            beforeChangeDate: '',
            searchDate: '',
            searchDate1: '',
            isFunction: false,
            isCode: false,
            isProperty: false,
            isSecurity: false,
            modal0: false,
            modal1: false,
            modal2: false,
            modal3: false,
            modal4: false,
            modal5: false,
            modal6: false,
            modal7: false,
            loading: false,
            nowTime: '',
            userName: '',
            proname: 'XXXX',
            deliverable: 'XXX',
            Baselinetime: 'XX年XX月XX日',
            Versionnumber: 'XXX',
            group: 'XXX',
            Testresult: '',
            conclusion0: '',
            conclusion1: '',
            conclusion2: '',
            conclusion3: '',
            alldata: {},
            functionResult: null,
            codeResult: null,
            capacityResult: null,
            securityResult: null,
            functioncolumns: [
                {
                    title: '日期',
                    key: 'time'
                },
                {
                    title: 'bug/漏洞/指标',
                    key: 'level'
                },
                {
                    title: '今日发现bug数',
                    key: 'find'
                },
                {
                    title: '今日解决bug数',
                    key: 'resolve'
                },
                {
                    title: '今日重新打开bug数',
                    key: 'open'
                },
                {
                    title: '累计发现bug数量/结果',
                    key: 'accumulate'
                },
                {
                    title: '累计遗留bug数量/结果',
                    key: 'remain'
                }
            ],
            functiondata: [],
            codecolumns: [
                {
                    title: '日期',
                    key: 'time'
                },
                {
                    title: 'bug/漏洞/指标',
                    key: 'level'
                },
                {
                    title: '今日发现bug数',
                    key: 'find'
                },
                {
                    title: '今日解决bug数',
                    key: 'resolve'
                },
                {
                    title: '今日重新打开bug数',
                    key: 'open'
                },
                {
                    title: '累计发现bug数量/结果',
                    key: 'accumulate'
                },
                {
                    title: '累计遗留bug数量/结果',
                    key: 'remain'
                }
            ],
            codedata: [],
            propertycolumns: [
                {
                    title: '日期',
                    key: 'time'
                },
                {
                    title: 'bug/漏洞/指标',
                    key: 'type'
                },
                {
                    title: '达标数量',
                    key: 'pass'
                },
                {
                    title: '不达标数量',
                    key: 'fail'
                },
                {
                    title: '达标率',
                    key: 'passrate'
                }
            ],
            propertydata: [],
            securitycolumns: [
                {
                    title: '日期',
                    key: 'time'
                },
                {
                    title: 'bug/漏洞/指标',
                    key: 'level'
                },
                {
                    title: '今日发现bug数',
                    key: 'find'
                },
                {
                    title: '今日解决bug数',
                    key: 'resolve'
                },
                {
                    title: '今日重新打开bug数',
                    key: 'open'
                },
                {
                    title: '累计发现bug数量/结果',
                    key: 'accumulate'
                },
                {
                    title: '累计遗留bug数量/结果',
                    key: 'remain'
                }
            ],
            securitydata: [],
            notriskcolumns: [
                {
                    title: '风险及障碍描述',
                    key: 'description',
                    align: 'center',
                    width: 400
                },
                {
                    title: '状态',
                    key: 'desState',
                    align: 'center',
                    render: (h, params) => {
                        let that = this
                        if (params.row.desState == 1) {
                            return h('span', {
                                style: {
                                    fontWeight: 500
                                },
                            }, '开启')
                        } else if (params.row.desState == 0) {
                            return h('span', {
                                style: {
                                    fontWeight: 500
                                },
                            }, '关闭')
                        }
                    }
                },
                {
                    title: '创建时间',
                    key: 'cTime',
                    align: 'center'
                },
                {
                    title: '操作',
                    key: 'action',
                    align: 'center',
                    render: (h, params) => {
                        return h('div', [
                            h('span', [
                                h('Poptip', {
                                    props: {
                                        confirm: true,
                                        transfer: true,
                                        placement: 'left-start',
                                        title: '关闭后将无法恢复，确定关闭该风险及障碍吗？',
                                        type: 'error',
                                        size: 'small',
                                        width: '300',
                                        vModel: true
                                    },
                                    on: {
                                        'on-ok': ()=>{
                                            let that = this
                                            let closeparams = {
                                                id: params.row.id,
                                                desState: 0
                                            }
                                            $.ajax({
                                                type: 'POST',
                                                url: '/api/PTJ/journal/updateDesState.do',
                                                data: JSON.stringify(closeparams),
                                                contentType: 'text/plain',
                                                success: (data) => {
                                                    if (data.status === 0) {
                                                        vm.checkNotCloseRisk()
                                                    } else if (data.status === 10) {
                                                        that.$Notice.warning({
                                                            title: '登录超时',
                                                            desc: '用户登录超时，即将跳转到登录页面'
                                                        })
                                                        setTimeout(that.userout(), 5000)
                                                    }
                                                },
                                                error: (err) => {
                                                    console.log(err)
                                                }
                                            })
                                        },
                                        'on-cancel': ()=>{
                                            console.log("取消")
                                        }
                                    }
                                }, [
                                    h('Button', {
                                        props: {
                                            type: 'primary',
                                            size: 'small'
                                        },
                                        style: {
                                            fontSize: '12px'
                                        }
                                    }, '关闭')
                                ])
                            ])
                        ]);
                    }
                }
            ],
            notriskdata: [],
            riskcolumns: [
                {
                    title: '风险及障碍描述',
                    key: 'description',
                    align: 'center',
                    width: 400
                },
                {
                    title: '状态',
                    key: 'desState',
                    align: 'center',
                    render: (h, params) => {
                        let that = this
                        if (params.row.desState == 1) {
                            return h('span', {
                                style: {
                                    fontWeight: 500
                                },
                            }, '开启')
                        } else if (params.row.desState == 0) {
                            return h('span', {
                                style: {
                                    fontWeight: 500
                                },
                            }, '关闭')
                        }
                    }
                },
                {
                    title: '创建时间',
                    key: 'cTime',
                    align: 'center'
                }
            ],
            riskdata: [],
            barseries: []
        },
        mounted() {
            this.userName = sessionStorage.getItem('userName')
            this.getNowDate()
            this.proname = sessionStorage.getItem('projectname')
            this.selectReport()
            let timestamp = new Date().getTime()
            this.searchDate = this.timestampToTime1(timestamp)
            this.searchDate1 = timestamp
        },
        methods: {
            barcode () {
                let id = sessionStorage.getItem('projectid')
                let projectId = 'projectId=' + id
                let that = this
                    $.ajax({
                    type: 'POST',
                    url: '/api/PTJ/journal/statisticsDesState.do',
                    data: projectId,
                    contentType: 'application/x-www-form-urlencoded',
                    success: function(data){
                        if (data.status === 0) {
                            that.barseries.push(data.data.runDesSUM)
                            that.barseries.push(data.data.closedDesSUM)
                            that.$nextTick(function() {
                                that.drawbar('Bar1')
                                that.drawbar('Bar2')
                            })
                        }
                    },
                    error: function(){
                        console.log('error')
                    }
                })
            },
            drawbar(id){
                this.charts = echarts.init(document.getElementById(id))
                this.charts.setOption({
                    title : {
                    text: '风险及障碍状态图',
                    x:'center',
                    textStyle: {
                        fontSize: 15
                    }
                    },
                    tooltip : {
                        trigger: 'axis',
                        axisPointer : {            // 坐标轴指示器，坐标轴触发有效
                            type : 'shadow'        // 默认为直线，可选为：'line' | 'shadow'
                        }
                    },
                    grid: {
                        left: '6%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis : [
                        {
                            type : 'category',
                            data:["未关闭风险及障碍", "已关闭风险及障碍"]
                        }
                    ],
                    yAxis : [
                        {
                            type : 'value'
                        }
                    ],
                    series : [{
                        data: this.barseries,
                        type: 'bar',
                        barWidth : 30,
                        itemStyle: {   
                            //通常情况下：
                            normal:{  
            　　　　　　　　　　　　//每个柱子的颜色即为colorList数组里的每一项，如果柱子数目多于colorList的长度，则柱子颜色循环使用该数组
                                color: function (params){
                                    var colorList = ['#CD2626','#3CB371'];
                                    return colorList[params.dataIndex];
                                }
                            }
                        },
                    }]
                })
            },
            checkNotCloseRisk() {
                this.notriskdata = []
                var projectId = 'projectId=' + sessionStorage.getItem('projectid')
                var promis = new Promise(function (resolve, reject) {
                    $.ajax({
                        type: 'POST',
                        url: '/api/PTJ/journal/descriptionRunList.do',
                        data: projectId,
                        contentType: 'application/x-www-form-urlencoded',
                        success: (data) => {
                            resolve(data)
                        },
                        error: (err) => {
                            reject(err)
                        }
                    })
                })
                let that = this
                promis.then(function (data) {
                    if (data.status === 0) {
                        for (let i = 0; i < data.data.length; i++) {
                            let NotClosedatalist = data.data[i]
                            NotClosedatalist.cTime = that.timestampToTime1(data.data[i].cTime)
                            that.notriskdata.push(NotClosedatalist)
                        }
                        if (!that.modal6){
                            that.modal6 = true
                        }
                        that.barcode()
                    } else if (data.status === 10) {
                        that.$Notice.warning({
                            title: '登录超时',
                            desc: '用户登录超时，即将跳转到登录页面'
                        })
                        setTimeout(that.userout(), 5000)
                    }
                }).catch(function (err) {
                    console.log(err)
                });
            },
            checkCloseRisk() {
                this.riskdata = []
                var projectId = 'projectId=' + sessionStorage.getItem('projectid')
                var promis = new Promise(function (resolve, reject) {
                    $.ajax({
                        type: 'POST',
                        url: '/api/PTJ/journal/descriptionClosedList.do',
                        data: projectId,
                        contentType: 'application/x-www-form-urlencoded',
                        success: (data) => {
                            resolve(data)
                        },
                        error: (err) => {
                            reject(err)
                        }
                    })
                })
                let that = this
                promis.then(function (data) {
                    if (data.status === 0) {
                        for (let i = 0; i < data.data.length; i++) {
                            let Closedatalist = data.data[i]
                            Closedatalist.cTime = that.timestampToTime1(data.data[i].cTime)
                            that.riskdata.push(Closedatalist)
                        }
                        that.modal7 = true
                    } else if (data.status === 10) {
                        that.$Notice.warning({
                            title: '登录超时',
                            desc: '用户登录超时，即将跳转到登录页面'
                        })
                        setTimeout(that.userout(), 5000)
                    }
                }).catch(function (err) {
                    console.log(err)
                });
            },
            functionHistory() {
                let projectId = 'projectId=' + sessionStorage.getItem('projectid')
                let that = this
                $.ajax({
                    type: 'POST',
                    url: '/api/PTJ/journal/functionHistoryList.do',
                    data: projectId,
                    contentType: 'application/x-www-form-urlencoded',
                    success: function (data) {
                        if (data.status === 0) {
                            that.functiondata = []
                            for(let i=0; i<data.data.length; i++) {
                                let itemA = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: 'A级别',
                                    find: data.data[i].bugA,
                                    resolve: data.data[i].bugAClosed,
                                    open: data.data[i].bugAReopen,
                                    accumulate: data.data[i].bugASum,
                                    remain: data.data[i].bugARemain
                                }
                                that.functiondata.push(itemA)
                                let itemB = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: 'B级别',
                                    find: data.data[i].bugB,
                                    resolve: data.data[i].bugBClosed,
                                    open: data.data[i].bugBReopen,
                                    accumulate: data.data[i].bugBSum,
                                    remain: data.data[i].bugBRemain
                                }
                                that.functiondata.push(itemB)
                                let itemC = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: 'C级别',
                                    find: data.data[i].bugC,
                                    resolve: data.data[i].bugCClosed,
                                    open: data.data[i].bugCReopen,
                                    accumulate: data.data[i].bugCSum,
                                    remain: data.data[i].bugCRemain
                                }
                                that.functiondata.push(itemC)
                                let itemD = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: 'D级别',
                                    find: data.data[i].bugD,
                                    resolve: data.data[i].bugDClosed,
                                    open: data.data[i].bugDReopen,
                                    accumulate: data.data[i].bugDSum,
                                    remain: data.data[i].bugDRemain
                                }
                                that.functiondata.push(itemD)
                            }
                            that.modal2 = true
                        } else if (data.status === 10) {
                            that.$Notice.warning({
                                title: '登录超时',
                                desc: '用户登录超时，即将跳转到登录页面'
                            })
                            setTimeout(that.userout(), 5000)
                        }
                    },
                    error: function () {
                        console.log('error')
                    }
                })
            },
            codeHistory() {
                let projectId = 'projectId=' + sessionStorage.getItem('projectid')
                let that = this
                $.ajax({
                    type: 'POST',
                    url: '/api/PTJ/journal/codeHistoryList.do',
                    data: projectId,
                    contentType: 'application/x-www-form-urlencoded',
                    success: function (data) {
                        if (data.status === 0) {
                            that.codedata = []
                            for(let i=0; i<data.data.length; i++) {
                                let itemA = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: 'A级别',
                                    find: data.data[i].bugA,
                                    resolve: data.data[i].bugAClosed,
                                    open: data.data[i].bugAReopen,
                                    accumulate: data.data[i].bugASum,
                                    remain: data.data[i].bugARemain
                                }
                                that.codedata.push(itemA)
                                let itemB = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: 'B级别',
                                    find: data.data[i].bugB,
                                    resolve: data.data[i].bugBClosed,
                                    open: data.data[i].bugBReopen,
                                    accumulate: data.data[i].bugBSum,
                                    remain: data.data[i].bugBRemain
                                }
                                that.codedata.push(itemB)
                            }
                            that.modal3 = true
                        } else if (data.status === 10) {
                            that.$Notice.warning({
                                title: '登录超时',
                                desc: '用户登录超时，即将跳转到登录页面'
                            })
                            setTimeout(that.userout(), 5000)
                        }
                    },
                    error: function () {
                        console.log('error')
                    }
                })
            },
            propertyHistory() {
                let projectId = 'projectId=' + sessionStorage.getItem('projectid')
                let that = this
                $.ajax({
                    type: 'POST',
                    url: '/api/PTJ/journal/propertyHistoryList.do',
                    data: projectId,
                    contentType: 'application/x-www-form-urlencoded',
                    success: function (data) {
                        if (data.status === 0) {
                            that.propertydata = []
                            for(let i=0; i<data.data.length; i++) {
                                let itemA = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    type: '云端性能',
                                    pass: data.data[i].cloudPass,
                                    fail: data.data[i].cloudFail,
                                    passrate: data.data[i].cloudPassRate,
                                }
                                that.propertydata.push(itemA)
                                let itemB = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    type: 'Web性能',
                                    pass: data.data[i].webPass,
                                    fail: data.data[i].webFail,
                                    passrate: data.data[i].webPassRate,
                                }
                                that.propertydata.push(itemB)
                            }
                            that.modal4 = true
                        } else if (data.status === 10) {
                            that.$Notice.warning({
                                title: '登录超时',
                                desc: '用户登录超时，即将跳转到登录页面'
                            })
                            setTimeout(that.userout(), 5000)
                        }
                    },
                    error: function () {
                        console.log('error')
                    }
                })
            },
            securityHistory() {
                let projectId = 'projectId=' + sessionStorage.getItem('projectid')
                let that = this
                $.ajax({
                    type: 'POST',
                    url: '/api/PTJ/journal/securityHistoryList.do',
                    data: projectId,
                    contentType: 'application/x-www-form-urlencoded',
                    success: function (data) {
                        if (data.status === 0) {
                            that.securitydata = []
                            for(let i=0; i<data.data.length; i++) {
                                let itemA = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: '高危',
                                    find: data.data[i].bugH,
                                    resolve: data.data[i].bugHClosed,
                                    open: data.data[i].bugHReopen,
                                    accumulate: data.data[i].bugHSum,
                                    remain: data.data[i].bugHRemain
                                }
                                that.securitydata.push(itemA)
                                let itemB = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: '中危',
                                    find: data.data[i].bugM,
                                    resolve: data.data[i].bugMClosed,
                                    open: data.data[i].bugMReopen,
                                    accumulate: data.data[i].bugMSum,
                                    remain: data.data[i].bugMRemain
                                }
                                that.securitydata.push(itemB)
                                let itemC = {
                                    time: that.timestampToTime1(data.data[i].cTime),
                                    level: '低危',
                                    find: data.data[i].bugL,
                                    resolve: data.data[i].bugLClosed,
                                    open: data.data[i].bugLReopen,
                                    accumulate: data.data[i].bugLSum,
                                    remain: data.data[i].bugLRemain
                                }
                                that.securitydata.push(itemC)
                            }
                            that.modal5 = true
                        } else if (data.status === 10) {
                            that.$Notice.warning({
                                title: '登录超时',
                                desc: '用户登录超时，即将跳转到登录页面'
                            })
                            setTimeout(that.userout(), 5000)
                        }
                    },
                    error: function () {
                        console.log('error')
                    }
                })
            },
            ok2() {
                this.modal2 = false
            },
            cancel2() {
                this.modal2 = false
            },
            ok3() {
                this.modal3 = false
            },
            cancel3() {
                this.modal3 = false
            },
            ok4() {
                this.modal4 = false
            },
            cancel4() {
                this.modal4 = false
            },
            ok5() {
                this.modal5 = false
            },
            cancel5() {
                this.modal5 = false
            },
            ok6() {
                this.modal6 = false
            },
            cancel6() {
                this.modal6 = false
            },
            ok7() {
                this.modal7 = false
            },
            cancel7() {
                this.modal7 = false
            },
            handleClick() {
                if (this.open === true) {
                    this.open = false
                } else {
                    this.modal1 = true
                }
            },
            ok1() {
                this.modal1 = false
                this.open = true
            },
            cancel1() {
                this.open = false
                this.modal1 = false
            },
            ChangeDate(date) {
                this.searchDate = date
                this.searchDate1 = date
                let cdate = new Date(this.searchDate1) //时间对象
                let choicetime = cdate.getTime() //转换成时间戳
                this.selectReport(this.searchDate1)
                this.open = false
            },
            convertUTCTimeToLocalTime(UTCDateString) {
                if (!UTCDateString) {
                    return '-';
                }

                function formatFunc(str) {    //格式化显示
                    return str > 9 ? str : '0' + str
                }

                var date2 = new Date(UTCDateString);     //这步是关键
                var year = date2.getFullYear();
                var mon = formatFunc(date2.getMonth() + 1);
                var day = formatFunc(date2.getDate());
                var hour = date2.getHours();
                var noon = hour >= 12 ? 'PM' : 'AM';
                hour = hour >= 12 ? hour - 12 : hour;
                hour = formatFunc(hour);
                var min = formatFunc(date2.getMinutes());
                var dateStr = year + '-' + mon + '-' + day;
                return dateStr;
            },
            selectReport(usertime) {
                let id = sessionStorage.getItem('projectid')
                let params = {
                    projectId: id,
                    startTime: '',
                    endTime: ''
                }
                if (usertime === undefined) {
                    let timestamp = new Date().getTime()
                    params.startTime = this.timestampToTime1(timestamp)
                    params.endTime = this.timestampToTime1(timestamp)
                } else {
                    params.startTime = usertime
                    params.endTime = usertime
                }
                let that = this
                $.ajax({
                    type: 'POST',
                    url: '/api/PTJ/journal/select.do',
                    data: JSON.stringify(params),
                    contentType: 'text/plain',
                    success: function (data) {
                        if (data.status === 0) {
                            if (data.data.state === 1) {
                                that.Testresult = '测试执行'
                            } else if (data.data.state === 2) {
                                that.Testresult = '测试完成'
                            }
                            if (data.data.isFunction === 1) {
                                that.isFunction = true
                                that.functionResult = data.data.functionJournal.result
                            }
                            if (data.data.isCode === 1) {
                                that.isCode = true
                                that.codeResult = data.data.codeJournal.result
                            }
                            if (data.data.isProperty === 1) {
                                that.isProperty = true
                                that.capacityResult = data.data.propertyJournal.result
                            }
                            if (data.data.isSecurity === 1) {
                                that.isSecurity = true
                                that.securityResult = data.data.securityJournal.result
                            }
                            that.alldata = data.data
                        } else if (data.status === 10) {
                            that.$Notice.warning({
                                title: '登录超时',
                                desc: '用户登录超时，即将跳转到登录页面'
                            })
                            setTimeout(that.userout(), 5000)
                        }
                    },
                    error: function () {
                        console.log('error')
                    }
                })
            },
            timestampToTime1(timestamp) {
                var date = new Date(timestamp)
                Y = date.getFullYear() + '-'
                M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-'
                D = (date.getDate() < 10 ? '0' + (date.getDate()) : date.getDate()) + ' '
                return Y + M + D
            },
            getNowDate: function () {
                setInterval(() => {
                    var date = new Date()
                    var seperator1 = '-'
                    var seperator2 = ':'
                    var month = date.getMonth() + 1
                    var strDate = date.getDate()
                    var hours = date.getHours()
                    var minutes = date.getMinutes()
                    var seconds = date.getSeconds()
                    if (month >= 1 && month <= 9) {
                        month = '0' + month
                    }
                    if (strDate >= 0 && strDate <= 9) {
                        strDate = '0' + strDate
                    }
                    if (hours >= 0 && hours <= 9) {
                        hours = '0' + hours
                    }
                    if (minutes >= 0 && minutes <= 9) {
                        minutes = '0' + minutes
                    }
                    if (seconds >= 0 && seconds <= 9) {
                        seconds = '0' + seconds
                    }
                    var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate +
                        ' ' + hours + seperator2 + minutes +
                        seperator2 + seconds
                    this.nowTime = currentdate
                }, 1000)
            },
            changeTime: function () {
                if (this.searchTime === '自定义') {
                    this.isuserdefined = true
                } else {
                    this.isuserdefined = false
                }
            },
            ok() {
                this.userout()
            },
            cancel() {
                // this.$Message.info('Clicked cancel')
            },
            goBack() {
                window.location.pathname = 'index.html'
            },
            functionRadio() {
                if (this.functionResult === 2) {
                    this.alldata.functionJournal.bugA = 0
                    this.alldata.functionJournal.bugAClosed = 0
                    this.alldata.functionJournal.bugAReopen = 0
                    this.alldata.functionJournal.bugB = 0
                    this.alldata.functionJournal.bugBClosed = 0
                    this.alldata.functionJournal.bugBReopen = 0
                    this.alldata.functionJournal.bugC = 0
                    this.alldata.functionJournal.bugCClosed = 0
                    this.alldata.functionJournal.bugCReopen = 0
                    this.alldata.functionJournal.bugD = 0
                    this.alldata.functionJournal.bugDClosed = 0
                    this.alldata.functionJournal.bugDReopen = 0
                }
            },
            codeRadio() {
                if (this.codeResult === 2) {
                    this.alldata.codeJournal.bugA = 0
                    this.alldata.codeJournal.bugAClosed = 0
                    this.alldata.codeJournal.bugAReopen = 0
                    this.alldata.codeJournal.bugB = 0
                    this.alldata.codeJournal.bugBClosed = 0
                    this.alldata.codeJournal.bugBReopen = 0
                }
            },
            propertyRadio() {
                if (this.capacityResult === 2) {
                    this.alldata.propertyJournal.cloudPass = 0
                    this.alldata.propertyJournal.cloudFail = 0
                    this.alldata.propertyJournal.webPass = 0
                    this.alldata.propertyJournal.webFail = 0
                }
            },
            securityRadio() {
                if (this.securityResult === 2) {
                    this.alldata.securityJournal.bugH = 0
                    this.alldata.securityJournal.bugHClosed = 0
                    this.alldata.securityJournal.bugHReopen = 0
                    this.alldata.securityJournal.bugM = 0
                    this.alldata.securityJournal.bugMClosed = 0
                    this.alldata.securityJournal.bugMReopen = 0
                    this.alldata.securityJournal.bugL = 0
                    this.alldata.securityJournal.bugLClosed = 0
                    this.alldata.securityJournal.bugLReopen = 0
                }
            },
            goSubmit() {
                this.loading = true
                if (this.searchDate === '') {
                    this.$Notice.error({
                        title: '日报填写日期不能为空',
                        desc: ''
                    })
                    this.loading = false
                } else {
                    let choicetime = ''
                    if (this.searchDate1.toString().indexOf("-") > 0) {
                        let date = new Date(this.searchDate1) //时间对象
                        choicetime = date.getTime() //转换成时间戳
                    } else {
                        choicetime = this.searchDate1
                    }
                    let addparams = {
                        projectStateVOList: null,
                        state: null,
                        isFunction: null,
                        isCode: null,
                        isProperty: null,
                        isSecurity: null,
                        projectJournal: {
                            id: null,
                            projectId: sessionStorage.getItem('projectid'),
                            cTime: choicetime,
                            description: this.alldata.projectJournal.description
                        },
                        functionJournal: {
                            id: null,
                            journalId: null,
                            bugA: null,
                            bugASum: null,
                            bugARemain: null,
                            bugB: null,
                            bugBSum: null,
                            bugBRemain: null,
                            bugC: null,
                            bugCSum: null,
                            bugCRemain: null,
                            bugD: null,
                            bugDSum: null,
                            bugDRemain: null,
                            result: null
                        },
                        codeJournal: {
                            id: null,
                            journalId: null,
                            bugA: null,
                            bugAClosed: null,
                            bugAReopen: null,
                            bugASum: null,
                            bugARemain: null,
                            bugB: null,
                            bugBClosed: null,
                            bugBReopen: null,
                            bugBSum: null,
                            bugBRemain: null,
                            result: null
                        },
                        propertyJournal: {
                            id: null,
                            journalId: null,
                            cloudPass: null,
                            cloudFail: null,
                            cloudFailSum: null,
                            webPass: null,
                            webFail: null,
                            webFailSum: null,
                            result: null,
                            cloudPassRate: null,
                            webPassRate: null
                        },
                        securityJournal: {
                            id: null,
                            journalId: null,
                            bugH: null,
                            bugHClosed: null,
                            bugHReopen: null,
                            bugHSum: null,
                            bugHRemain: null,
                            bugM: null,
                            bugMClosed: null,
                            bugMReopen: null,
                            bugMSum: null,
                            bugMRemain: null,
                            bugL: null,
                            bugLClosed: null,
                            bugLReopen: null,
                            bugLSum: null,
                            bugLRemain: null,
                            result: null
                        }
                    }
                    if (this.alldata.isFunction === 0) {
                        addparams.functionJournal = null
                    } else {
                        addparams.functionJournal.bugA = this.alldata.functionJournal.bugA
                        addparams.functionJournal.bugAClosed = this.alldata.functionJournal.bugAClosed
                        addparams.functionJournal.bugAReopen = this.alldata.functionJournal.bugAReopen
                        addparams.functionJournal.bugB = this.alldata.functionJournal.bugB
                        addparams.functionJournal.bugBClosed = this.alldata.functionJournal.bugBClosed
                        addparams.functionJournal.bugBReopen = this.alldata.functionJournal.bugBReopen
                        addparams.functionJournal.bugC = this.alldata.functionJournal.bugC
                        addparams.functionJournal.bugCClosed = this.alldata.functionJournal.bugCClosed
                        addparams.functionJournal.bugCReopen = this.alldata.functionJournal.bugCReopen
                        addparams.functionJournal.bugD = this.alldata.functionJournal.bugD
                        addparams.functionJournal.bugDClosed = this.alldata.functionJournal.bugDClosed
                        addparams.functionJournal.bugDReopen = this.alldata.functionJournal.bugDReopen
                        addparams.functionJournal.result = this.alldata.functionJournal.result
                    }
                    if (this.alldata.isCode === 0) {
                        addparams.codeJournal = null
                    } else {
                        addparams.codeJournal.bugA = this.alldata.codeJournal.bugA
                        addparams.codeJournal.bugAClosed = this.alldata.codeJournal.bugAClosed
                        addparams.codeJournal.bugAReopen = this.alldata.codeJournal.bugAReopen
                        addparams.codeJournal.bugB = this.alldata.codeJournal.bugB
                        addparams.codeJournal.bugBClosed = this.alldata.codeJournal.bugBClosed
                        addparams.codeJournal.bugBReopen = this.alldata.codeJournal.bugBReopen
                        addparams.codeJournal.result = this.alldata.codeJournal.result
                    }
                    if (this.alldata.isProperty === 0) {
                        addparams.propertyJournal = null
                    } else {
                        addparams.propertyJournal.cloudPass = this.alldata.propertyJournal.cloudPass
                        addparams.propertyJournal.cloudFail = this.alldata.propertyJournal.cloudFail
                        addparams.propertyJournal.webPass = this.alldata.propertyJournal.webPass
                        addparams.propertyJournal.webFail = this.alldata.propertyJournal.webFail
                        addparams.propertyJournal.result = this.alldata.propertyJournal.result
                    }
                    if (this.alldata.isSecurity === 0) {
                        addparams.securityJournal = null
                    } else {
                        addparams.securityJournal.bugH = this.alldata.securityJournal.bugH
                        addparams.securityJournal.bugHClosed = this.alldata.securityJournal.bugHClosed
                        addparams.securityJournal.bugHReopen = this.alldata.securityJournal.bugHReopen
                        addparams.securityJournal.bugM = this.alldata.securityJournal.bugM
                        addparams.securityJournal.bugMClosed = this.alldata.securityJournal.bugMClosed
                        addparams.securityJournal.bugMReopen = this.alldata.securityJournal.bugMReopen
                        addparams.securityJournal.bugL = this.alldata.securityJournal.bugL
                        addparams.securityJournal.bugLClosed = this.alldata.securityJournal.bugLClosed
                        addparams.securityJournal.bugLReopen = this.alldata.securityJournal.bugLReopen
                        addparams.securityJournal.result = this.alldata.securityJournal.result
                    }
                    let updateparams = {
                        projectStateVOList: null,
                        state: null,
                        isFunction: null,
                        isCode: null,
                        isProperty: null,
                        isSecurity: null,
                        projectJournal: {
                            id: this.alldata.projectJournal.id,
                            projectId: this.alldata.projectJournal.projectId,
                            cTime: choicetime,
                            description: this.alldata.projectJournal.description
                        },
                        functionJournal: {
                            id: null,
                            journalId: null,
                            bugA: null,
                            bugAClosed: null,
                            bugAReopen: null,
                            bugASum: null,
                            bugARemain: null,
                            bugB: null,
                            bugBClosed: null,
                            bugBReopen: null,
                            bugBSum: null,
                            bugBRemain: null,
                            bugC: null,
                            bugCClosed: null,
                            bugCReopen: null,
                            bugCSum: null,
                            bugCRemain: null,
                            bugD: null,
                            bugDClosed: null,
                            bugDReopen: null,
                            bugDSum: null,
                            bugDRemain: null,
                            result: null
                        },
                        codeJournal: {
                            id: null,
                            journalId: null,
                            bugA: null,
                            bugAClosed: null,
                            bugAReopen: null,
                            bugASum: null,
                            bugARemain: null,
                            bugB: null,
                            bugBClosed: null,
                            bugBReopen: null,
                            bugBSum: null,
                            bugBRemain: null,
                            result: null
                        },
                        propertyJournal: {
                            id: null,
                            journalId: null,
                            cloudPass: null,
                            cloudFail: null,
                            cloudFailSum: null,
                            webPass: null,
                            webFail: null,
                            webFailSum: null,
                            result: null,
                            cloudPassRate: null,
                            webPassRate: null
                        },
                        securityJournal: {
                            id: null,
                            journalId: null,
                            bugH: null,
                            bugHClosed: null,
                            bugHReopen: null,
                            bugHSum: null,
                            bugHRemain: null,
                            bugM: null,
                            bugMClosed: null,
                            bugMReopen: null,
                            bugMSum: null,
                            bugMRemain: null,
                            bugL: null,
                            bugLClosed: null,
                            bugLReopen: null,
                            bugLSum: null,
                            bugLRemain: null,
                            result: null
                        }
                    }
                    if (this.alldata.isFunction === 0) {
                        updateparams.functionJournal = null
                    } else {
                        updateparams.functionJournal.id = this.alldata.functionJournal.id
                        updateparams.functionJournal.journalId = this.alldata.functionJournal.journalId
                        updateparams.functionJournal.bugA = this.alldata.functionJournal.bugA
                        updateparams.functionJournal.bugAClosed = this.alldata.functionJournal.bugAClosed
                        updateparams.functionJournal.bugAReopen = this.alldata.functionJournal.bugAReopen
                        updateparams.functionJournal.bugASum = this.alldata.functionJournal.bugASum
                        updateparams.functionJournal.bugARemain = this.alldata.functionJournal.bugARemain
                        updateparams.functionJournal.bugB = this.alldata.functionJournal.bugB
                        updateparams.functionJournal.bugBClosed = this.alldata.functionJournal.bugBClosed
                        updateparams.functionJournal.bugBReopen = this.alldata.functionJournal.bugBReopen
                        updateparams.functionJournal.bugBSum = this.alldata.functionJournal.bugBSum
                        updateparams.functionJournal.bugBRemain = this.alldata.functionJournal.bugBRemain
                        updateparams.functionJournal.bugC = this.alldata.functionJournal.bugC
                        updateparams.functionJournal.bugCClosed = this.alldata.functionJournal.bugCClosed
                        updateparams.functionJournal.bugCReopen = this.alldata.functionJournal.bugCReopen
                        updateparams.functionJournal.bugCSum = this.alldata.functionJournal.bugCSum
                        updateparams.functionJournal.bugCRemain = this.alldata.functionJournal.bugCRemain
                        updateparams.functionJournal.bugD = this.alldata.functionJournal.bugD
                        updateparams.functionJournal.bugDClosed = this.alldata.functionJournal.bugDClosed
                        updateparams.functionJournal.bugDReopen = this.alldata.functionJournal.bugDReopen
                        updateparams.functionJournal.bugDSum = this.alldata.functionJournal.bugDSum
                        updateparams.functionJournal.bugDRemain = this.alldata.functionJournal.bugDRemain
                        updateparams.functionJournal.result = this.alldata.functionJournal.result
                    }
                    if (this.alldata.isCode === 0) {
                        updateparams.codeJournal = null
                    } else {
                        updateparams.codeJournal.id = this.alldata.codeJournal.id
                        updateparams.codeJournal.journalId = this.alldata.codeJournal.journalId
                        updateparams.codeJournal.bugA = this.alldata.codeJournal.bugA
                        updateparams.codeJournal.bugAClosed = this.alldata.codeJournal.bugAClosed
                        updateparams.codeJournal.bugAReopen = this.alldata.codeJournal.bugAReopen
                        updateparams.codeJournal.bugASum = this.alldata.codeJournal.bugASum
                        updateparams.codeJournal.bugARemain = this.alldata.codeJournal.bugARemain
                        updateparams.codeJournal.bugB = this.alldata.codeJournal.bugB
                        updateparams.codeJournal.bugBClosed = this.alldata.codeJournal.bugBClosed
                        updateparams.codeJournal.bugBReopen = this.alldata.codeJournal.bugBReopen
                        updateparams.codeJournal.bugBSum = this.alldata.codeJournal.bugBSum
                        updateparams.codeJournal.bugBRemain = this.alldata.codeJournal.bugBRemain
                        updateparams.codeJournal.result = this.alldata.codeJournal.result
                    }
                    if (this.alldata.isProperty === 0) {
                        updateparams.propertyJournal = null
                    } else {
                        updateparams.propertyJournal.id = this.alldata.propertyJournal.id
                        updateparams.propertyJournal.journalId = this.alldata.propertyJournal.journalId
                        updateparams.propertyJournal.cloudPass = this.alldata.propertyJournal.cloudPass
                        updateparams.propertyJournal.cloudFail = this.alldata.propertyJournal.cloudFail
                        updateparams.propertyJournal.cloudFailSum = this.alldata.propertyJournal.cloudFailSum
                        updateparams.propertyJournal.webPass = this.alldata.propertyJournal.webPass
                        updateparams.propertyJournal.webFail = this.alldata.propertyJournal.webFail
                        updateparams.propertyJournal.webFailSum = this.alldata.propertyJournal.webFailSum
                        updateparams.propertyJournal.result = this.alldata.propertyJournal.result
                        updateparams.propertyJournal.cloudPassRate = this.alldata.propertyJournal.cloudPassRate
                        updateparams.propertyJournal.webPassRate = this.alldata.propertyJournal.webPassRate
                    }
                    if (this.alldata.isSecurity === 0) {
                        updateparams.securityJournal = null
                    } else {
                        updateparams.securityJournal.id = this.alldata.securityJournal.id
                        updateparams.securityJournal.journalId = this.alldata.securityJournal.journalId
                        updateparams.securityJournal.bugH = this.alldata.securityJournal.bugH
                        updateparams.securityJournal.bugHClosed = this.alldata.securityJournal.bugHClosed
                        updateparams.securityJournal.bugHReopen = this.alldata.securityJournal.bugHReopen
                        updateparams.securityJournal.bugHSum = this.alldata.securityJournal.bugHSum
                        updateparams.securityJournal.bugHRemain = this.alldata.securityJournal.bugHRemain
                        updateparams.securityJournal.bugM = this.alldata.securityJournal.bugM
                        updateparams.securityJournal.bugMClosed = this.alldata.securityJournal.bugMClosed
                        updateparams.securityJournal.bugMReopen = this.alldata.securityJournal.bugMReopen
                        updateparams.securityJournal.bugMSum = this.alldata.securityJournal.bugMSum
                        updateparams.securityJournal.bugMRemain = this.alldata.securityJournal.bugMRemain
                        updateparams.securityJournal.bugL = this.alldata.securityJournal.bugL
                        updateparams.securityJournal.bugLClosed = this.alldata.securityJournal.bugLClosed
                        updateparams.securityJournal.bugLReopen = this.alldata.securityJournal.bugLReopen
                        updateparams.securityJournal.bugLSum = this.alldata.securityJournal.bugLSum
                        updateparams.securityJournal.bugLRemain = this.alldata.securityJournal.bugLRemain
                        updateparams.securityJournal.result = this.alldata.securityJournal.result
                    }
                    let params = {}
                    if (this.alldata.projectJournal.id === null) {
                        params = addparams
                    } else {
                        params = updateparams
                    }
                    let that = this
                    $.ajax({
                        type: 'POST',
                        url: '/api/PTJ/journal/commit.do',
                        data: JSON.stringify(params),
                        contentType: 'text/plain',
                        success: function (data) {
                            if (data.status === 0) {
                                that.$Notice.success({
                                    title: data.msg,
                                    desc: ''
                                })
                            } else if (data.status === 1) {
                                that.$Notice.error({
                                    title: '提交失败',
                                    desc: data.msg
                                })
                            } else {
                                that.$Notice.error({
                                    title: '提交失败',
                                    desc: data.msg
                                })
                            }
                            that.loading = false
                        },
                        error: function () {
                            that.loading = false
                            console.log('error')
                        }
                    })
                }
            },
            userout: function () {
                $.ajax({
                    type: 'POST',
                    url: '/api/PTJ/user/logout.do',
                    contentType: 'text/plain',
                    success: function (data) {
                        if (data.status === 0) {
                            sessionStorage.removeItem('authorityid')
                            sessionStorage.removeItem('projectid')
                            sessionStorage.removeItem('projectname')
                            sessionStorage.removeItem('checkReportDate')
                            sessionStorage.removeItem('lastprojectlist')
                            sessionStorage.removeItem('allTimelist')
                            sessionStorage.removeItem('listTime')
                            sessionStorage.removeItem('listdefineTime')
                            sessionStorage.removeItem('listgroup')
                            sessionStorage.removeItem('listitem')
                            window.location.pathname = 'login.html'
                        }
                    },
                    error: function () {
                        console.log('error')
                    }
                })
            }
        },
        watch: {
            functionResult: function (newValue, oldValue) {
                if (oldValue === 2) {
                    this.alldata.functionJournal.bugA = null
                    this.alldata.functionJournal.bugAClosed = null
                    this.alldata.functionJournal.bugAReopen = null
                    this.alldata.functionJournal.bugB = null
                    this.alldata.functionJournal.bugBClosed = null
                    this.alldata.functionJournal.bugBReopen = null
                    this.alldata.functionJournal.bugC = null
                    this.alldata.functionJournal.bugCClosed = null
                    this.alldata.functionJournal.bugCReopen = null
                    this.alldata.functionJournal.bugD = null
                    this.alldata.functionJournal.bugDClosed = null
                    this.alldata.functionJournal.bugDReopen = null
                }
                this.alldata.functionJournal.result = newValue
            },
            codeResult: function (newValue, oldValue) {
                if (oldValue === 2) {
                    this.alldata.codeJournal.bugA = null
                    this.alldata.codeJournal.bugAClosed = null
                    this.alldata.codeJournal.bugAReopen = null
                    this.alldata.codeJournal.bugB = null
                    this.alldata.codeJournal.bugBClosed = null
                    this.alldata.codeJournal.bugBReopen = null
                }
                this.alldata.codeJournal.result = newValue
            },
            capacityResult: function (newValue, oldValue) {
                if (oldValue === 2) {
                    this.alldata.propertyJournal.cloudPass = null
                    this.alldata.propertyJournal.cloudFail = null
                    this.alldata.propertyJournal.webPass = null
                    this.alldata.propertyJournal.webFail = null
                }
                this.alldata.propertyJournal.result = newValue
            },
            securityResult: function (newValue, oldValue) {
                if (oldValue === 2) {
                    this.alldata.securityJournal.bugH = null
                    this.alldata.securityJournal.bugHClosed = null
                    this.alldata.securityJournal.bugHReopen = null
                    this.alldata.securityJournal.bugM = null
                    this.alldata.securityJournal.bugMClosed = null
                    this.alldata.securityJournal.bugMReopen = null
                    this.alldata.securityJournal.bugL = null
                    this.alldata.securityJournal.bugLClosed = null
                    this.alldata.securityJournal.bugLReopen = null
                }
                this.alldata.securityJournal.result = newValue
            }
        }
    })
</script>
</body>
</html>
